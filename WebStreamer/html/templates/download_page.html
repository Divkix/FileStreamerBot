<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>FileStreamBot - Download Page</title>

    <meta
      name="description"
      content="Download website for FileStreamBot, wait for a few seconds to download your content."
    />
    <meta name="author" content="DivideProjects" />
    <meta property="og:title" content="Download website for FileStreamBot" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://divkix.me" />
    <meta
      property="og:description"
      content="Download website for FileStreamBot, wait for a few seconds to download your content."
    />
    <meta property="og:image" content="assets/img/favicon.png" />
    <link rel="icon" href="assets/img/favicon.png" />
    <link rel="icon" href="assets/img/favicon.png" type="image/svg+xml" />
    <link rel="apple-touch-icon" href="assets/img//apple-touch-icon.png" />

    <script async src="https://arc.io/widget.min.js#iV2ngVtF"></script>
    <script src="https://js.hcaptcha.com/1/api.js" async defer></script>
    <script
      async
      src="https://ackee.divkix.me/tracker.js"
      data-ackee-server="https://ackee.divkix.me"
      data-ackee-domain-id="76b6ce15-fbd8-4187-b822-ae4798fa38ed"
      data-ackee-opts='{ "detailed": true }'
    ></script>
    <script>
      function onSubmit(token) {
        const btn = document.getElementById("vBtn");
        console.log("Response Token: ", token);
        // enable the button after the captcha is solved
        sendPostReq(token, btn);
      }
      function sendPostReq(rToken, btn) {
        btn.value = "Verifying...";
        const url = "https://hcaptcha-verifier.divkix.me/verify";
        var options = {
          method: "POST",
          body: JSON.stringify({
            token: rToken,
          }),
          headers: {
            accept: "application/json",
            "Content-Type": "application/json",
          },
        };

        fetch(url, options)
          .then((data) => data.json())
          .then(function (data) {
            const success = data["success"];
            if (success) {
              console.log("Captcha Solve Success");
              // enable download button
              btn.value = "Download";
              btn.disabled = false;
            } else {
              console.log("Captcha Solve Failed:\n", data);
              // send a alert to reload te page
              alert("Captcha Failed, Please Reload the page and Try Again!");
            }
          })
          .catch((err) => console.error("Error: ", err));
      }
    </script>

    <style>
      html {
        height: 100%;
        display: table;
        margin: auto;
      }
      body {
        /* background-color: #f1c2ff; */
        height: 100%;
        display: table-cell;
        vertical-align: middle;
      }
      .btn {
        background-color: DodgerBlue;
        border: none;
        color: white;
        padding: 12px 30px;
        cursor: pointer;
        font-size: 20px;
      }
      .btn[disabled] {
        border: 1px solid #999999;
        background-color: #cccccc;
        color: #666666;
      }
      divBody {
        text-align: center;
      }
    </style>
  </head>

  <body>
    <div class="divBody">
      <b>Please verify the captcha to download the file!</b>
      <br />
      <br />
      <div
        class="h-captcha"
        data-sitekey="b349154f-f7b7-4752-bcfd-187cb50f4b75"
        data-callback="onSubmit"
      ></div>
      <br />
      <input
        type="button"
        id="vBtn"
        class="btn"
        onclick="window.open('{{ download_link }}')"
        style="width: 100%"
        disabled="false"
        value="Solve Captcha"
      />
    </div>
  </body>
</html>
